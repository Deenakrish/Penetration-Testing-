
# STEP 2 – Protocol Specific Vulnerability Checks

The purpose of this step is to identify vulnerabilities in running services on a target host, which helps in determining potential entry points for exploitation. 

This includes version detection and vulnerability mapping of services like FTP, SSH, Telnet, SMTP, and DNS.

---

## 2.1 SMB Vulnerability Assessment – Using nmap --script smb-vuln*

## Purpose

To detect known SMB-related vulnerabilities by running protocol-specific Nmap scripts that check for insecure or outdated SMB implementations.

### **Why This Tool Is Used**
The `nmap --script smb-vuln*`is used to check:
- To automatically test for known SMB vulnerabilities such as MS10-054 and MS10-061.
- To determine whether the SMB service is exploitable or properly patched.
- To identify misconfigurations or weak SMB protocol implementations.
- To quickly assess SMB security without needing manual exploitation.
- To validate whether SMB can be used as an attack vector in later phases.


---

### **Command**
    sudo nmap --script smb-vuln* -p 445 192.168.56.102

## Output
    Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-11 10:23 IST
    Nmap scan report for 192.168.56.102
    Host is up (0.00055s latency).

    PORT    STATE SERVICE
    445/tcp open  microsoft-ds
    MAC Address: 08:00:27:F0:BB:3D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

    Host script results:
    |_smb-vuln-regsvc-dos: ERROR: Script execution failed (use -d to debug)
    |_smb-vuln-ms10-061: false
    |_smb-vuln-ms10-054: false

    Nmap done: 1 IP address (1 host up) scanned in 6.30 seconds


## Findings
- Port 445 (SMB) is open and reachable.
- Port 445 (SMB) is open and reachable.
  - MS10-061 (Print Spooler RCE)
  - MS10-054 (SMB memory corruption)
- The script smb-vuln-regsvc-dos failed to execute, resulting in incomplete information.
- SMB service appears to be patched against the vulnerabilities checked.

## Interpretation
- The SMB service is active and accessible, but not immediately exploitable.
- The host is not vulnerable to several major historical SMB exploits.
- Additional tools may be required to validate DoS-related risks due to script failure.
- SMB remains a potential enumeration target, but exploitation opportunities appear limited.
- The system shows signs of being maintained or hardened against known SMB vulnerabilities.
---

## 2.2 FTP Vulnerability Assessment

## 2.2.1 Anonymous Login Test – Using ftp-anon Script

## Purpose

To determine whether the FTP server allows anonymous login, which can expose sensitive files or permit unauthorized access.

### **Why This Tool Is Used**
The `ftp-anon Script`is used to check:
- To check if the FTP service permits anonymous authentication.
- To identify misconfigured FTP access controls.
- To assess whether attackers can access public or sensitive directories without credentials.
- To validate FTP as a potential entry point for initial compromise.


---

### **Command**
    sudo nmap --script ftp-anon -p 21 192.168.56.102

## Output
    Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-11 10:24 IST
    Nmap scan report for 192.168.56.102
    Host is up (0.00048s latency).

    PORT   STATE SERVICE
    21/tcp open  ftp
    |_ftp-anon: Anonymous FTP login allowed (FTP code 230)
    MAC Address: 08:00:27:F0:BB:3D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

    Nmap done: 1 IP address (1 host up) scanned in 1.27 seconds

## Findings
- The FTP service is running on port 21.
- Anonymous login is enabled, confirmed by FTP response code 230.
- No additional restrictions or warnings are shown.

## Interpretation
- Attackers can log in without credentials, increasing unauthorized access risk.
- Files stored in FTP directories may be publicly accessible or downloadable.
- This is a critical misconfiguration often used for privilege escalation.
- The system requires immediate FTP hardening, including disabling anonymous access.
- Further directory enumeration is recommended to identify sensitive data exposure.

## 2.2.2 Known FTP Vulnerabilities Scan – Using ftp-vuln* Script

## Purpose
To identify whether the FTP service is affected by any known vulnerabilities, such as misconfigurations, buffer overflows, or outdated FTP server versions.

The `ftp-vuln script`is used to check:
- To check for publicly known FTP exploits associated with the server version.
- To detect misconfigurations, weak permissions, or insecure commands.
- To validate whether the FTP server is patched or outdated.
- To understand if FTP can be used as a vector for remote code execution or DoS attacks.

---

### **Command**

    sudo nmap --script ftp-vuln* -p 21 192.168.56.102


## Output
    Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-11 10:25 IST
    Nmap scan report for 192.168.56.102
    Host is up (0.00029s latency).
  
    PORT   STATE SERVICE
    21/tcp open  ftp
    MAC Address: 08:00:27:F0:BB:3D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

    Nmap done: 1 IP address (1 host up) scanned in 0.40 seconds

## Findimgs
- Port 21 (FTP) is open and responding.
- No known vulnerabilities detected by Nmap’s ftp-vuln* scripts.
- The FTP server did not trigger any vulnerability signatures.

## Interpretation 
- The FTP server appears to be patched or not affected by known vulnerabilities scanned.
- Despite no vulnerabilities found, anonymous login still poses a significant security risk.
- Lack of detected vulnerabilities does not guarantee the server is secure; further manual testing may be required.
- The server might be running an older version with limited script coverage.
- FTP should still be considered a high-risk surface due to insecure configuration.

---





- DNS service is outdated: may allow denial-of-service or remote exploits.
- Overall, the host is highly vulnerable, and FTP/SSH are priority targets for penetration testing.
